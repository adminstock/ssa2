*Документ предназначен для программистов и разработчиков.*

*﻿Для комфортной работы с этим документом в Visual Studio рекомендуется установить [Markdown Editor](https://visualstudiogallery.msdn.microsoft.com/eaab33c3-437b-4918-8354-872dfe5d1bfe).*

---

# Приложение SmallServerAdmin

Это основное клиентское приложение, которое представляет пользовательский интерфейс и реализует взаимодействие с серверным **API**.

## Подготовка к работе

Проект создан в среде [Visual Studio 2015](https://www.visualstudio.com) (с пакетом обновлений **Update 3**).

Для правильной и комфортной работы с этим проектом требуются следующие инструменты:

* [Node.js](https://nodejs.org/) (v4.4.7 + npm v2.15.8)
* [TypeScript](https://www.typescriptlang.org/) (v1.8)
* [Webpack Task Runner](https://visualstudiogallery.msdn.microsoft.com/5497fd10-b1ba-474c-8991-1438ae47012a)
* [NPM Scripts Task Runner](https://visualstudiogallery.msdn.microsoft.com/8f2f2cbc-4da5-43ba-9de2-c9d08ade4941)

Первый запуск **Visual Studio** рекомендуется проводить с правам администратора, чтобы не было проблем с получением и сборкой модулей **Node.js**.

Если все необходимое установлено, при первом запуске студия произведет автоматическую инициализацию проекта. 
Это не очевидно. В корне проекта появится папка **node_modules**, также может быть заметная нагрузка на процессор. 
Процесс инициализации займет некоторое время.

Вы может выполнить инициализацию вручную, через командную строку, до запуска **Visual Studio**:

```
:: 1. Перейти в каталог проекта app
cd F:\AdminStock\SmallServerAdmin2\app

:: Если проект находится на диске отличном от C:
:: не забудьте переключить диск:
F:

:: 2. Инициализация
npm install
```

## Структура проекта

* **AppStart** - папка с основными файлами приложения:
  * **Init.tsx** - маршруты, конфигурация и инициализация приложения;
  * **Index.tsx** - главная страница **SmallServerAdmin**.
* **bin** - бесполезная папка, создается **Visual Studio** автоматически при сборке проекта. Эта папка не должна входить в решение.
* **Content** - дополнительный статичный контент (стили, шрифты, изображения):
  * **Images** - изображения;
  * **Sprites** - изображения для создания спрайтов:
    * ***Любая папка*** - имя группы спрайтов.
  * **Styles** - файлы стилей:
    * **.sprites** - папка со стилями спрайтов, создается автоматически (эта папка не должна быть включена в решение);
    * ***Любые файлы .scss и папки***.
* **dist** - папка с собранными, готовыми к использованию, файлами проекта. Создается при сборке веб-пакета (**webpack**). Правила сборки описаны в файле **webpack.config.js**. Эта папка не должна входить в решение.
* **Helpers** - вспомогательные классы (классы-помощники).
* **Layouts** - шаблоны (мастер-страницы).
* **Models** - общие структуры/классы для представления данных.
* **Modules** - модули **SmallServerAdmin**:
  * ***Любой модуль***
    * **Index.tsx** - главная страница модуля;
    * ***Любые другие файлы и папки***.
* **node_modules** - модули **Node.js**, создается автоматически. Модули загружаются в соответствии с правилами, указанными в файле **package.json**. Эта папка не должна входить в решение.
* **obj** - папка с выходными файлами компоновщика, создается **Visual Studio** автоматически. Эта папка не должна входить в решение.
* **src** - папка, в которую компилируется код **TypeScript**. Создается автоматически. Эта папка не должна входить в решение.
* **typings** - папка с автоматически полученными файлами определения типов **TypeScript**. Содержимое папки формируется в соответствии с конфигурацией, описанной в файле **typings.json**. Изменять содержимое этой папки вручную не нужно. Для правильной работы в **Visual Studio**, эта папка и все содержимое должны быть включены в решение.
* **typings.local** - папка с локальными файлами определения типов **TypeScript**, для удобства работы с кодом и использования не существующих в коде объектов. Создается вручную.
* **UI** - общие элементы пользовательского интерфейса.
* **index.html** - основная и единственная страница приложения.
* **package.json** - файл **NPM**, главным образом отвечает за обработку зависимостей.
* **typings.json** - содержит пакеты с определениями типов **TypeScript** для используемых в проекте **JavaScript** библиотек.
* **web.config** - конфигурация для веб-сервера **IIS** (необходим для запуска приложения на локальном сервере, в **Visual Studio**).
* **webpack.config.js** - файл конфигурации **Webpack**, который отвечает за сборку конечных результатов.

*Примечание: все автоматически создаваемые папки можно спокойно удалять. Более того, это иногда может быть необходимо, если возникнут проблемы со сборкой проекта.*

## Проблемы и решения

### Ничего не происходит

Если вы тыкаете по ссылкам сайта и ничего не происходит, убедитесь, что веб-сервер запущен :)

### Invariant Violation

> Uncaught Invariant Violation: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: undefined. Check the render method of `Index`.

Это какой-то непонятный глюк, который иногда может возникать.
Для решения проблемы необходимо пересобрать проект (пакет - клиентский код, **webpack**).

Лучше всего через меню: Сборка -> Пересобрать или Сборка -> Очистить + Сборка -> Собрать.

Затем собрать **webpack** (если не включена автоматическая сборка по событию "Сборка").

Также перед сборкой можно попробовать удалить старый код из папок `/app/src` и `/app/dist`.

### Cannot resolve 'file' or 'directory' ./AppStart/Init in /SmallServerAdmin2/app/src

> ERROR in Entry module not found: Error: Cannot resolve 'file' or 'directory' ./AppStart/Init in F:\AdminStock.net\SmallServerAdmin2\app/src

Проблема в том, что файлы **TypeScript** не были компилированы в **JavaScript**.

Необходимо выполнить сборку **TypeScript** (Сборка -> Собрать проект/решение).

Сборка не будет выполнена, если в коде есть ошибки (см. Вид -> Вывод и/или Вид -> Список ошибок).

### ERROR in UNKNOWN: unknown error, open 'ABC:\SmallServerAdmin2\app\dist\images\web-servers.png'

По каким-то причинам нет доступа к указанному файлу (файл может быть любым).

Можно попробовать повторить попытку сборки пакета, либо разобраться, что стало причиной блокировки.

### Missing localization

Сообщение означает, что нет ресурсов локализации для указанных строк.

Ресурсы, как правило, добавляются после завершения работы над проектом или его отдельными частями.

Это не ошибка. Не обращайте внимания.